PESAPAL PAYMENT INTEGRATION - QUICK START
==========================================

âœ… INTEGRATION COMPLETE! 

Follow these steps to test payments:

STEP 1: Add to your .env file
------------------------------
PESAPAL_ENV=sandbox
PESAPAL_CONSUMER_KEY=your_key_here
PESAPAL_CONSUMER_SECRET=your_secret_here
PESAPAL_IPN_ID=
PESAPAL_CURRENCY=USD

STEP 2: Run migrations
----------------------
php artisan migrate

STEP 3: Register IPN
--------------------
php artisan pesapal:register-ipn

Copy the IPN ID from output and add to .env:
PESAPAL_IPN_ID="paste_here"

STEP 4: Clear cache
-------------------
php artisan config:clear
php artisan cache:clear

STEP 5: Test!
-------------
1. Make a booking on your website
2. Click pay now
3. You should see the Pesapal iframe
4. Complete payment with test cards
5. Check logs: storage/logs/laravel.log

IMPORTANT ROUTES
---------------
Payment Process: /payment/{bookingId}
Payment Success: /payment/success
Payment IPN: /payment/confirmation

FILES CREATED
-------------
âœ“ config/pesapal.php
âœ“ app/Console/Commands/RegisterPesapalIpn.php
âœ“ app/Console/Kernel.php
âœ“ database/migrations/2025_10_07_200000_update_payments_table_for_pesapal.php
âœ“ PESAPAL_SETUP.md (detailed guide)

FILES UPDATED
-------------
âœ“ app/Http/Controllers/PaymentController.php
âœ“ app/Models/Booking.php
âœ“ app/Models/Payment.php
âœ“ bootstrap/app.php
âœ“ resources/views/website/pages/pesapal.blade.php
âœ“ resources/views/website/pages/payment_success.blade.php

TROUBLESHOOTING
--------------
- Check logs: tail -f storage/logs/laravel.log
- Verify credentials are correct
- Ensure APP_URL is accessible (use ngrok for local)
- IPN must be publicly accessible for callbacks

For detailed documentation, see PESAPAL_SETUP.md

NEXT STEPS
----------
1. Get Pesapal sandbox credentials from https://www.pesapal.com
2. Follow Step 1-4 above
3. Test complete booking flow
4. When ready for live, switch to live credentials and re-register IPN

Good luck! ðŸš€

